<html>
<head>
	<title>Concordia Schedule Viewer</title>
</head>
<body>
	<textarea id="box" rows="30">
</textarea>
	<button onclick="parse()">Parse</button>
</body>
<script type="text/javascript">
function parse(){
	box = document.getElementById('box').value;
	//remove the icon placeholder text
	box = box.replace(/Academic Calendar Deadlines\n/g,"");
	//remove white space from the beginning
	while(box.match(/^\n/g)){
		box = box.replace(/^\n/g,"");
	}
	//remove white space from the end
	while(box.match(/\n$/g)){
		box = box.replace(/\n$/g,"");
	}

	//split into array
	data = box.split("\n");

	//check the size
	if (data.length%4!=0){
		alert("error. There are extra characters before/after the pasted info.");
		return -1;
	}

	numClasses = data.length/4;
	scheduleJSON = {
		"schedule"	: []
	}

	//for each scheduled class
	for (i=0;i<numClasses;i++){

		//break into an object
		classObject = {
			"class" : data[4*i], 
			"type" 	: data[4*i+1],
			"time" 	: data[4*i+2],
			"room" 	: data[4*i+3]
		};
		
		//break the object down if there is multiple time slots
		
		//if single time slot
		if (classObject.time.match(/^..\s/g)){
			scheduleJSON.schedule.push(classObject);
		}
		else if (classObject.time.match(/^....\s/g)){
			ending = classObject.time.substring(4);
			day1 = classObject.time.substring(0,2) + ending;
			tempObject = {
				"class" : classObject.class, 
				"type" 	: classObject.type,
				"time" 	: day1,
				"room" 	: classObject.room
			};
			scheduleJSON.schedule.push(tempObject);
			day2 = classObject.time.substring(2,4) + ending;
			tempObject = {
				"class" : classObject.class, 
				"type" 	: classObject.type,
				"time" 	: day2,
				"room" 	: classObject.room
			};
			scheduleJSON.schedule.push(tempObject);
		}
		else{
			alert("error. The time slots do not seem to be in a supported format.");
			return -2;
		}
	}
}
</script>
</html>